Title: "[從.Net工程師的角度來看DevOps 22]免費的CI Server - AppVeyor介紹"
Published: 2017-12-12
Modified: 2017-12-12
Image: /posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb(56).png
Tags: ["「ithome 第八屆鐵人賽」","devops","「從.net工程師的角度來看devops」"]
RedirectFrom: 2017/12/devopsSeries-ci-server-appveyor-intro.html
Series: ["「iThome 第八屆鐵人賽」","「從.Net工程師的角度來看DevOps」"]
---
<section><figure><a href="https://lh3.googleusercontent.com/-Hqy_fIdCFAM/Wi_1WP2OPOI/AAAAAAAAXAg/BORHmFVxd6kzd5pkQ0EUefHLMLruA3UFACHMYCw/s1600-h/image%255B2%255D"><img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb(56).png" border="0" class="img-responsive"></a><br><span style="line-height: 1.6; font-size: 15px;">圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/</span><br></figure></section><section><p>		在上一篇(<a href="http://blog.alantsai.net/2017/07/devopsSeries-refactorScriptAndBuildServerIntro.html" target="_blank">[從.Net工程師的角度來看DevOps 21]Build階段的總結和重構 - Build Server介紹</a><span style="line-height: 1.6;">)對我們的build script在做了一次重構之後，這篇我們來看看一個佛心的CI Server：Appveyor。</span></p><p>		CI Server不是什麼新的概念，一直以來有一些免費的CI Server可以使用，例如Travis CI - 不過多是Linux base的Server。 		但是由於Windows版權的問題，.Net沒有什麼免費（至少從Open Source專案角度來看）的CI Server 可以用，直到AppVeyor的出現，和後來的Visual Studio Team Service。 		</p><p>		在這篇，將會簡單介紹AppVeyor，並且如何把我們的專案準備好，在下一篇在介紹如何整合AppVeryor執行我們的build script。 		</p></section><section><a name="KMContentPageTopID" id="KMContentPageTopID"></a><div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"><ul style="margin: 0px 0px 0px 20px;"><li><a style="line-height: 1.6;" href="#WizKMOutline_1513091861004651" ;="">AppVeyor小檔案</a><br></li><li><a style="line-height: 1.6;" href="#WizKMOutline_1513091861004485" ;="">加入要自動建制的專案</a><br></li><li><a style="line-height: 1.6;" href="#WizKMOutline_1513091861004920" ;="">用AppVeryor內建的方式來build專案</a><br></li><li><a style="line-height: 1.6;" href="#WizKMOutline_1513091861004674" ;="">結語</a><br></li></ul></div></section><a name="more"></a><section><h2 id="WizKMOutline_1513091861004651">AppVeyor小檔案</h2><div class="bs-callout bs-callout-default"><ul><li>官方網站：<a href="https://www.appveyor.com/">https://www.appveyor.com/</a></li><li>收費方式：Open Source專案免費，私人專案最低 每個月 29 美金。詳細請看：<a href="https://www.appveyor.com/pricing/">https://www.appveyor.com/pricing/</a></li><li>使用手冊：<a href="https://www.appveyor.com/docs/">https://www.appveyor.com/docs/</a></li></ul></div><p>		會需要先註冊一個帳號，註冊完之後會進入到<code>Projects</code>的畫面，這邊我們就可以建立要CI執行的專案。 		</p></section><section><h2 id="WizKMOutline_1513091861004485">加入要自動建制的專案</h2><p>		選擇<code>New Project</code></p><figure><a href="https://lh3.googleusercontent.com/-jbcsgO3QHcs/Wi_1cOAICtI/AAAAAAAAXAo/8UUY1xgd1PUZCmYdpyou-kQ8uIRFm9aUwCHMYCw/s1600-h/image%255B5%255D"><img width="654" height="102" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[1](50).png" border="0" class="img-responsive"></a><br><figcaption>選擇New Project</figcaption></figure><p>		這個專案在Github，所以要先授權讀取Github repo： 		</p><a href="https://lh3.googleusercontent.com/-4I8iJeA_SJE/Wi_1gW8qMzI/AAAAAAAAXAw/gs0xTT8Na5g6bUFDAigUm3NTYlJiprR5gCHMYCw/s1600-h/image%255B13%255D"><img width="460" height="229" title="image" style="display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[5](27).png" border="0" class="img-responsive"></a><figure><a href="https://lh3.googleusercontent.com/-qUwD6Wxhh80/Wi_1kSz4YhI/AAAAAAAAXA4/yHfjXfnHJrATGL5H4jrni7_ZEhGCzVvSwCHMYCw/s1600-h/image%255B12%255D"><img width="372" height="417" title="image" style="display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[4](37).png" border="0" class="img-responsive"></a><br><figcaption>選擇授權github，在確認畫面記得如果專案在Organization要記得勾選</figcaption></figure><p>		確認之後，會回到AppVeyor的畫面，找到要自動建制的專案並且按下<code>Add</code></p><figure><a href="https://lh3.googleusercontent.com/-jdyjPSwBW9E/Wi_1reqPDXI/AAAAAAAAXBA/PiCCOvYtQtgbRv3zml-C_ZdR81RdnCY8ACHMYCw/s1600-h/image%255B16%255D"><img width="654" height="306" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[6](24).png" border="0" class="img-responsive"></a><br><figcaption>加入要建制的專案</figcaption></figure><p>		加入了之後，會進入到這個專案的最新的build畫面（因為還沒有build過，所以是空的） 		</p><figure><a href="https://lh3.googleusercontent.com/-9UqSmwtZ8tE/Wi_11SrTbHI/AAAAAAAAXBI/K58X9EM0UboCgiQ-Vrl7bGYUK94T1NlNACHMYCw/s1600-h/image%255B19%255D"><img width="654" height="156" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[7](18).png" border="0" class="img-responsive"></a><br><figcaption>加入成功的畫面</figcaption></figure></section><section><h2 id="WizKMOutline_1513091861004920">用AppVeryor內建的方式來build專案</h2><p>		先來試試看沒有build script的情況下如何直接用Appveyor來build專案。 		</p><p>		什麼都不設定直接按下build，發現有出現一個錯誤，從訊息來看是缺少nuget restore。 		</p><figure><a href="https://lh3.googleusercontent.com/-WXeUfYRSxBA/Wi_1_F-eL9I/AAAAAAAAXBQ/EJehmmC6bxs42-8WOL9ZqucWUXOvjROYwCHMYCw/s1600-h/image%255B23%255D"><img width="502" height="112" title="image" style="display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[9](7).png" border="0" class="img-responsive"></a><a href="https://lh3.googleusercontent.com/-x2BS3MHFJzM/Wi_2ERZatJI/AAAAAAAAXBY/jEA_GIg4KfYtXXKfGOc-DiQYwIHFaWf6wCHMYCw/s1600-h/image%255B27%255D"><img width="511" height="276" title="image" style="display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[11](9).png" border="0" class="img-responsive"></a><figcaption>執行build之後，出現錯誤</figcaption></figure><p>		因此我們可以做一些設定： 		</p><ol><li>切換到<code>Settings</code>頁簽</li><li>選擇左邊<code>Build</code>的選項</li><li>在<code>Visual Studio solution or project file</code>先設定我們的sln位置，要不然AppVeryor會因為太多專案不知道建制那個而出錯。我們這邊輸入：<kbd>src\DevOpsUsingPsake.sln</kbd></li><li>再來要設定build之前要先restore，因此在<code>Before Build Script</code>選擇<code>CMD</code></li><li>這個VM裡面已經設定好有nuget在path裡面，所以可以直接呼叫<kbd>nuget restore src\DevOpsUsingPsake.sln</kbd></li><li>最後把修改做了儲存</li></ol><figure><a href="https://lh3.googleusercontent.com/-R-CrXpvxT5E/Wi_2NAz5dVI/AAAAAAAAXBg/ZRl5ZUNv794h29-__LVMGEH1Yn_znJUvwCHMYCw/s1600-h/image%255B30%255D"><img width="654" height="564" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[12](10).png" border="0" class="img-responsive"></a><br><figcaption>設定的畫面</figcaption></figure><p>		設定完之後，在build一次，這次就會成功，可以再<code>Test</code>頁簽看到我們的3個Test Dll。 		</p><figure><a href="https://lh3.googleusercontent.com/-rhqiqUXiI_o/Wi_2nOA26XI/AAAAAAAAXBo/LhdhMlgTSjsDI_g4K3HRVLXKrstKu-BoQCHMYCw/s1600-h/image%255B33%255D"><img width="654" height="267" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-12-devopsSeries-ci-server-appveyor-intro_Asset/image_thumb[13](9).png" border="0" class="img-responsive"></a><br><figcaption>出現綠色表示建制成功，並且看到Test dll有出現</figcaption></figure><div class="bs-callout bs-callout-info"><p>			直接用build server定義好的方式去建制CI其實非常容易，只是設定幾個值就建立好了。是不是有點覺得花那麼多時間來打造自己的script好像沒什麼意義？ 			</p><p>			用build server的方式是很容易，但是： 			</p><ol><li>沒辦法local跑，換句話說本地跑的build和build server跑的可能不同</li><li>每家build server語法不同，如果有天要換要重新設定</li><li>假設設定改壞了，根本無法了解是誰改了設定</li></ol></div></section><section><h2 id="WizKMOutline_1513091861004674">結語</h2><p>		這篇是一個快速介紹如何使用Appveyor，並且看了如何用Appveyor的內建設定快速定義出如何build我們專案。 		</p><p>		雖然用Appveyor的設定方式很方便就設定好了建制設定，但是有一個local script還是非常有必要。 		</p><p>		因此，在下篇，將會看如何用Appveyor執行我們的Build Script。 		</p></section><section>			<div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:1172fb07-5389-48a7-9844-7972b0461284" style="margin: 0px; padding: 0px; float: none; display: inline;">標籤: <a href="/tags/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag">「從.Net工程師的角度來看DevOps」</a>,<a href="/tags/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag">「iThome 第八屆鐵人賽」</a>,<a href="/tags/devops" rel="tag">devops</a></div>		</section>