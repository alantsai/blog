Title: "[tool]沒有mail server怎麼測試寄送email？快放過你的gmail來看看有那些可以測試用的smtp mail server"
Published: 2017-12-06
Modified: 2017-12-06
Image: /posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb(53).png
Tags: ["tool"]
RedirectFrom: 2017/12/test-smtp-server-for-sending-mail-in-development.html
Series: []
---
<section><figure><a href="https://lh3.googleusercontent.com/-VrTxp3T_ihA/WibUaWxcEuI/AAAAAAAAW4w/Hj6LaShB_BEIN9Q56DQudHAoMq9Q7nzgwCHMYCw/s1600-h/image%255B2%255D"><img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb(53).png" border="0" class="img-responsive"></a><br><figcaption>圖片來源：https://pixabay.com/en/despair-alone-being-alone-archetype-513528/</figcaption></figure></section><section><p>  不管什麼系統，只要需要通知使用者基本上都是使用email(電子郵件)方式通知，因此寄送email基本上是大部分系統都會需要的功能。   </p><p>  雖然正式環境一定會有mail server給我們使用，但是當我們在開發階段的時候，有時候需要測試寄送出來的mail內容是不是正確、有沒有跑版等問題，這個時候有一個測試用的mail server變得非常重要。   </p><p>  以前最常見應該就是借用gmail的mail server來測試發信，不過那個設定有些步奏，並且gmail也有做出一些限制，因此放過你的gmail吧，來看看有什麼工具可以讓我們測試email寄送。   </p><p>  關鍵字：測試mail server、測試smtp、mailtrap、smtp4dev、papercut、直接寫道檔案系統   </p><div class="bs-callout bs-callout-default">   測試機送mail的sample程式在github：<a href="https://github.com/alantsai-samples/dotnet-sendmail-smtp-server-review">dotnet-sendmail-smtp-server-review</a></div></section>  <section> <a name="KMContentPageTopID" id="KMContentPageTopID"></a><div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"><ul style="margin: 0px 0px 0px 20px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810434" ;="">比較表 - TL;DR</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810327" ;="">MailTrap</a><br></li><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810256" ;="">準備使用</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810445" ;="">測試結果</a><br></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810298" ;="">smtp4dev</a><br></li><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810946" ;="">準備環境</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810913" ;="">測試結果</a><br></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810155" ;="">papercut</a><br></li><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810819" ;="">準備環境</a></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810886" ;="">測試結果</a><br></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810316" ;="">直接寫到檔案</a><br></li><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810783" ;="">準備環境</a></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810606" ;="">測試結果</a></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1512493572810303" ;="">結語</a><br></li></ul></div></section>  <a name="more"></a><section><h2 id="WizKMOutline_1512493572810434">比較表 - TL;DR</h2><p>  這邊將會像大家介紹4個工具：   </p><ol><li>MailTrap</li><li>Smtp4Dev</li><li>papercut</li><li>直接寫到檔案</li></ol><table class="table"><tbody><tr><th></th><th><a href="#WizKMOutline_1512493572810327"><font color="#0000ff">MailTrap</font></a></th><th><a href="#WizKMOutline_1512493572810298"><font color="#0000ff">Smtp4dev</font></a></th><th><a href="#WizKMOutline_1512493572810155"><font color="#0000ff">papercut</font></a></th><th><a href="#WizKMOutline_1512493572810316"><font color="#0000ff">直接寫到檔案</font></a></th></tr><tr><th>是否需要連網?</th><td>✔</td><td style="background-color: yellow;">✖</td><td style="background-color: yellow;">✖</td><td style="background-color: yellow;">✖</td></tr><tr><th>是否需要執行程式?</th><td style="background-color: yellow;">✖</td><td>✔</td><td>✔</td><td style="background-color: yellow;">✖</td></tr><tr><th>是否能直接看到html呈現結果?</th><td style="background-color: yellow;">✔</td><td>✖</td><td style="background-color: yellow;">✔</td><td>✖</td></tr><tr><th>是否提供轉寄功能?</th><td>✖(付費版有)</td><td>✖</td><td style="background-color: yellow;">✔</td><td>✖</td></tr><tr><th>檢查html和css是否合法和垃圾郵件分數?</th><td style="background-color: yellow;">✔</td><td>✖</td><td>✖</td><td>✖</td></tr><tr><th>運作機制</th><td>Online服務提供測試的smtp server</td><td>建立local samtp server</td><td>建立local samtp server</td><td>把寄送mail內容寫到檔案</td></tr></tbody></table><p>  一般來說，我的使用順序會是：<em>MailTrap &gt; smtp4dev &gt; 直接寫到檔案 &gt; papercut</em></p><p>  Mailtrap能夠直接看到html內容，並且可以檢查html和css是否合法，最後能夠檢查出spam（垃圾郵件）指數。   </p><p>  不過有時候開發沒有網路的話，那麼就沒辦法用mailtrap，這個時候會改成使用smtp4dev只是用來收mail。   </p><p>  如果是在<em>正式機器</em>需要測試mail寄送，這個時候就會使用<em>直接寫到檔案</em>的方式來達到 - 因為在正式機器不一定能夠架設一個暫時的smtp server，因此smtp4dev無法使用。   </p><p>  只有當沒有網路並且要測試檢視html內容的時候才會考慮使用papercut。   </p></section><section><h2 id="WizKMOutline_1512493572810327">MailTrap</h2><p>  Mailtrap是一個網路的服務，最主要的好處是能夠直接看到html內容並且能夠檢查html和vss是否都合法，最後裡面也有一個檢查spam指數。   </p><section><h3 id="WizKMOutline_1512493572810256">準備使用</h3><div class="bs-callout bs-callout-info"><ul><li>服務網址：<a href="https://mailtrap.io/">https://mailtrap.io/</a></li><li>      免費版提供了一個mail box裡面最多可以放50封email。如果需要其他功能例如收到的mail轉寄等功能可以參考不同費用的差異：<a href="https://mailtrap.io/pricing">https://mailtrap.io/pricing</a></li></ul></div><p>  基本上和一般註冊服務沒什麼兩樣，註冊完了之後，可以直接建立一個<em>inbox</em>：   </p><figure><a href="https://lh3.googleusercontent.com/-vUCfKYxedM0/WibUct6Ht0I/AAAAAAAAW44/g1Ybqs7_goo2wvQAFTCPPVt7GB8Ee7vAgCHMYCw/s1600-h/image%255B5%255D"><img width="654" height="175" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[1](47).png" border="0" class="img-responsive"></a><br><figcaption>建立一個box</figcaption></figure><p>  建立出來了之後，可以直接點進去會看到：   </p><ol><li>smtp的host</li><li>smtp的帳號</li><li>smtp的密碼</li><li>可以切換到C#</li><li>直接看到如何使用的範例程式碼</li><li>可以直接重新產生帳號和密碼</li></ol><figure><a href="https://lh3.googleusercontent.com/-nHcQM5n6XPo/WibUfS8dlzI/AAAAAAAAW5A/TCLp_DRJT8EBaPviHMruy_I0z-E-ouopgCHMYCw/s1600-h/image%255B8%255D"><img width="654" height="415" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[2](39).png" border="0" class="img-responsive"></a><br><figcaption>取得mailtrap相關的資訊</figcaption></figure><p>  有了這些資訊之後，可以再<code>App.config</code>裡面設定成為：   </p><pre class="brush: xml;"><code class="language-markup line-numbers">&lt;system.net&gt;
    &lt;mailSettings&gt;
      &lt;smtp from="test@@test.com"&gt;
 &lt;network enableSsl="true" userName="{你的帳號}" password="{你的密碼}"
                  host="smtp.mailtrap.io"/&gt;
      &lt;/smtp&gt;
    &lt;/mailSettings&gt;
&lt;/system.net&gt;</code></pre>這邊把帳號和密碼改成你帳號裡面的值。   </section><section><h3 id="WizKMOutline_1512493572810445">測試結果</h3><p>   在inbox裡面會多出一封mail，點下去之後：    </p><figure><a href="https://lh3.googleusercontent.com/-LvoLHYVUcS0/WibUifjdDUI/AAAAAAAAW5I/DMeteoRSPAYeRlUP6N__drTfQBRyl_1wACHMYCw/s1600-h/image%255B11%255D"><img width="654" height="270" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[3](36).png" border="0" class="img-responsive"></a><br><figcaption>第一個頁簽可以看到html呈現的結果</figcaption></figure><p>   切換到<code>Analysis</code>頁簽可以看到：    </p><ol><li>Spam Score - 被歸到垃圾郵件的可能性分數 - 以我們這個為例子看起來還好</li><li>右邊有詳細每一個分數說明，並且如果對於每一個規則有疑問可以點下去會到wikpedia看到更多資訊</li><li>下面還會分析寄送來源的domain是不是屬於被黑名單</li></ol><figure><a href="https://lh3.googleusercontent.com/-uyGgTSU1Hq4/WibUmMnWWfI/AAAAAAAAW5Q/Ruf_cwNfnsUZH5K61rxGh7IbHQV4ktelwCHMYCw/s1600-h/image%255B14%255D"><img width="654" height="373" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[4](35).png" border="0" class="img-responsive"></a><br><figcaption>Analysis指數說明</figcaption></figure><div class="bs-callout bs-callout-warning">    這邊注意一下，Spam Score還是屬於一個參考值，低不代表就不會被歸類在垃圾郵件，畢竟還是要看收的client端的設定。    </div><p>   切換到<code>Check Html</code>的頁簽，可以看到檢查email的html和css是否符合規範。    </p><figure><a href="https://lh3.googleusercontent.com/-VmILhxXTHI0/WibUrNgxFOI/AAAAAAAAW5Y/3z5chtqmHnITort0rAbqpdPgkeR0k0OUACHMYCw/s1600-h/image%255B17%255D"><img width="654" height="228" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[5](26).png" border="0" class="img-responsive"></a><br><figcaption>這筆email的html和css沒有問題</figcaption></figure></section><p>  以上就是mailtrap的使用方式，和特色的部分，接下來看看<em>smtp4dev</em>。   </p></section><section><h2 id="WizKMOutline_1512493572810298">smtp4dev</h2><p>  這個工具是一個windows程式，開啟之後會建立一個smtp server在指定的port，因此mail寄送到這個工具裡面。   </p><section><h3 id="WizKMOutline_1512493572810946">準備環境</h3><div class="bs-callout bs-callout-info">    程式小檔案：     <ul><li>github官網：<a href="https://github.com/rnwood/smtp4dev">https://github.com/rnwood/smtp4dev</a></li><li>直接下載：<a href="https://github.com/rnwood/smtp4dev/releases/download/v2.0.10/smtp4dev-2.0.10-binaries.zip">smtp4dev 2.0.10</a></li><li>目前版本：v 2.0.10</li><li>檔案大小：約444 kb</li></ul></div><div class="bs-callout bs-callout-info">    smtp4dev最新版本是v3，這個版本用的是.Net Core並且改成使用web界面在瀏覽，這邊使用的還是v2的版本，因為windows程式很小run起來也不佔資源。    </div><p>   下載好之後，直接run起來，一開始會有一個防火墻規則要開通：    </p><figure><a href="https://lh3.googleusercontent.com/-AecQYN0g3YE/WibUvn2unAI/AAAAAAAAW5g/Pz3PaPVi0eoW_GbtogmBqDg8Xt7tWddXgCHMYCw/s1600-h/image%255B20%255D"><img width="654" height="474" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[6](23).png" border="0" class="img-responsive"></a><br><figcaption>開通防火墻</figcaption></figure><p>   預設聽的是port 25，假設要改可以透過<code>options</code>裡面的<code>server</code>頁簽，然後修改<code>port numbers</code></p><figure><a href="https://lh3.googleusercontent.com/-nJtCz9ScWfw/WibUz6uv0hI/AAAAAAAAW5o/zEENUZt1fxUrmc3fGPmcWwnP691eLLtoQCHMYCw/s1600-h/image%255B23%255D"><img width="654" height="390" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[7](17).png" border="0" class="img-responsive"></a><br><figcaption>預設聽的port</figcaption></figure><p>   調整<code>App.config</code>如下：    </p><pre class="brush: xml;"><code class="language-markup line-numbers">&lt;system.net&gt;
    &lt;mailSettings&gt;
      &lt;smtp from="test@@test.com"&gt;
        &lt;network host="localhost"/&gt;
      &lt;/smtp&gt;
    &lt;/mailSettings&gt;
&lt;/system.net&gt; 
   </code></pre></section><section><h3 id="WizKMOutline_1512493572810913">測試結果</h3><p>   用和上一封一樣的mail內容，寄送出去之後，會看到清單會有一筆資料，可以點下<code>Inspect</code>來看內容：    </p><figure><a href="https://lh3.googleusercontent.com/-Rl_43wwDfhE/WibU7CcNpUI/AAAAAAAAW5w/ysc0bbd2Bzcn4H2y8cUkMVenHdB15ekTACHMYCw/s1600-h/image%255B26%255D"><img width="654" height="143" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[8](17).png" border="0" class="img-responsive"></a><br><figcaption>看mail內容</figcaption></figure><p>   無法看到html的render內容，如果要看到，需要有一個mail的工具（例如outlook或者thunderbird），然後按下<code>View</code>就可以。    </p></section><p>  smtp4dev和mailtrap比起來的好處是<em>不需要網路</em>，但是看html內容不方便。如果需要看html的呈現結果，但是又不想聯網，可以使用papercut。   </p></section><section><h2 id="WizKMOutline_1512493572810155">papercut</h2><p>  papercut和smtp4dev是同一種類型的軟體，都是建立一個stmp的server。   </p><p>  papercut比smtp4dev的功能還來得豐富，例如轉寄出去等，不過這邊比較關注的是html呈現的部分。   </p><section><h3 id="WizKMOutline_1512493572810819">準備環境</h3><div class="bs-callout bs-callout-info"><h4 id="WizKMOutline_1512493572810569">程式小檔案</h4><ul><li>Github官網：<a href="https://github.com/ChangemakerStudios/Papercut">https://github.com/ChangemakerStudios/Papercut</a></li><li>直接下載：<a href="https://github.com/ChangemakerStudios/Papercut/releases/download/5.0.9/Papercut.5.0.9.zip">Papercut 5.0.9</a></li><li>目前版本：v5.0.9</li><li>檔案大小：約8.9MB</li></ul></div><p>   和smtp4dev一樣，啟動的時候會需要開啟防火墻：    </p><figure><a href="https://lh3.googleusercontent.com/-TUITnrzIons/WibVBOlsQ9I/AAAAAAAAW54/QlFWTFM34-ENp_Fsr-panRWHdwVTMciuACHMYCw/s1600-h/image%255B29%255D"><img width="654" height="498" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[9](6).png" border="0" class="img-responsive"></a><br><figcaption>設定防火墻</figcaption></figure><p>   預設port是25，如果要改可以透過<code>option</code>裡面的<code>port來調整</code></p><figure><a href="https://lh3.googleusercontent.com/-HDz9sCjt_8A/WibVEKZYJ8I/AAAAAAAAW6A/W4DuUB4UW3w2DumdwRLpyYHetU4iRt2CQCHMYCw/s1600-h/image%255B32%255D"><img width="654" height="308" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[10](6).png" border="0" class="img-responsive"></a><br><figcaption>設定port</figcaption></figure></section><section><h3 id="WizKMOutline_1512493572810886">測試結果</h3><p>   mail內容和設定可以和smtp4dev一樣，因此可以不用改，直接把程式run起來即可。    </p><p>   執行出來的結果如下：    </p><figure><a href="https://lh3.googleusercontent.com/-V1H__Tk7ElY/WibVGmAIdFI/AAAAAAAAW6I/m5YOTiifBLU0lhDDs50oN6pQ7UkdRl66QCHMYCw/s1600-h/image%255B35%255D"><img width="654" height="521" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[11](8).png" border="0" class="img-responsive"></a><br><figcaption>mail內容</figcaption></figure>    可以看到html內容會直接呈現出來。    </section><p>  papercut和smtp4dev除了html的部分還有就是轉寄(forward)的功能 - 這個轉寄功能還可以透過設定規則(rule)的方式來自動接到特定mail的時候自動轉寄出去。   </p><p>  一般來說papercut是當<em>沒有網路</em>的時候，要看email的<em>html呈現</em>才會使用。   </p><p>  有時候在正式機器需要測試寄送mail的內容，但是又沒辦法執行程式建立暫時的smtp server，這個時候就可以使用把mail寫到檔案的方式。   </p></section><section><h2 id="WizKMOutline_1512493572810316">直接寫到檔案</h2><p>  如果沒有網路，並且沒有上面提到的兩個程式（或者因為權限的關係無法執行起來），那麼就可以用直接寫道檔案的方式。   </p><section><h3 id="WizKMOutline_1512493572810783">準備環境</h3><p>   這個方式不需要安裝或者註冊什麼，只需要調整設定<code>App.config</code>即可：    </p><pre class="brush: xml;"><code class="language-markup line-numbers">&lt;system.net&gt;
    &lt;mailSettings&gt;
      &lt;smtp from="test@@test.com" deliveryMethod="SpecifiedPickupDirectory"&gt;
        &lt;specifiedPickupDirectory pickupDirectoryLocation="d:\temp\mail" /&gt;
      &lt;/smtp&gt;
    &lt;/mailSettings&gt;
&lt;/system.net&gt;
</code></pre><p>這邊主要設定會把mail內容寫到資料夾：<code>d:\temp\mail</code>下面。 </p><div class="bs-callout bs-callout-warning"> 這邊注意一下，資料夾是要存在的位置，如果不存在會出錯。 </div></section><section><h3 id="WizKMOutline_1512493572810606">測試結果</h3><p>   直接把測試軟體run起來寄送email，會在資料夾<code>d:\temp\mail</code>多出一個guid名稱的檔案：    </p><figure><a href="https://lh3.googleusercontent.com/-tZx6jVrRhr0/WibVIrUx_qI/AAAAAAAAW6Q/HbqFnxRdBuIoPkFCAr3EmBVq4dbBIaaQwCHMYCw/s1600-h/image%255B38%255D"><img width="654" height="394" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-06-test-smtp-server-for-sending-mail-in-development_Asset/image_thumb[12](9).png" border="0" class="img-responsive"></a><br><figcaption>呈現結果</figcaption></figure></section><p>  這個方式非常簡單，不需要任何服務或者任何軟體，隨時都可以設定，因此非常適合<em>比較無法控制的環境</em>測試的時候使用。   </p></section><section><h2 id="WizKMOutline_1512493572810303">結語</h2><p>  寄送mail是個很常見的功能，因此在開發或者測試的時候能夠測試寄送mail變得很重要。   </p><p>  希望透過這篇能夠讓未來要測試寄送mail的時候變得更加方便和容易。   </p></section><section>   <div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:b7d2b3cb-4fa6-4cb1-bae2-b6a644325ca4" style="margin: 0px; padding: 0px; float: none; display: inline;">標籤: <a href="/tags/tool" rel="tag">tool</a></div></section>