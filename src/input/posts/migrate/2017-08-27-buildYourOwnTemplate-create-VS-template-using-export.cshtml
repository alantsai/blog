Title: "[打造自己的template-建立一致性程式碼][03]透過匯出建立Project Template"
Published: 2017-08-27
Modified: 2017-08-27
Image: /posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb(26).png
Tags: ["visual studio","「打造自己的template-建立一致性程式碼」"]
RedirectFrom: 2017/08/buildYourOwnTemplate-create-VS-template-using-export.html
Series: ["「打造自己的template-建立一致性程式碼」"]
---
<section><figure><a href="https://lh3.googleusercontent.com/-lwkkE6kjAUw/WaJCTo3MeAI/AAAAAAAAWKg/wxbjy85pAcA8BFDS7KDRPDwonpru6n89ACHMYCw/s1600-h/image%255B2%255D"><img width="654" height="290" title="透過匯出建立Project Template" style="display: inline; background-image: none;" alt="透過匯出建立Project Template" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb(26).png" border="0" class="img-responsive"></a><br><figcaption>圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/</figcaption></figure></section><section><p>  在上一篇<a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-template-intro-sample-package-intro.html">[打造自己的template-建立一致性程式碼][02]了解template類型和建立出要變成範本的程式</a>建立出一個能夠用Console Process Template套件建立出來的的Echo程式之後，在這篇我們將會把建立的程式變成範本。   </p><p>  我們將會透過VS匯出的功能產生Template，並且介紹如何匯入匯出的template。   </p><section><div class="bs-callout bs-callout-default">上篇建立的sample 程式在 <a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter02">github mhat-visualstudio-template sample/chapter02</a></div></section></section>    <section> <a name="KMContentPageTopID" id="KMContentPageTopID"></a><div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"><ul style="margin: 0px 0px 0px 20px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714767899" ;="">匯出成Project Template</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768152" ;="">使用匯出的範本</a><br></li><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768815" ;="">Template放置的位置</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768579" ;="">匯入template</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768216" ;="">測試範本</a><br></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768757" ;="">結語</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1503805714768242" ;="">參考資料</a><br></li></ul></div></section>    <a name="more"></a>    <section><h2 id="WizKMOutline_1503805714767899">匯出成Project Template</h2><p>  建立Template的最簡單方式是透過Visual Studio（以下簡稱VS）的匯出功能。   </p><p>  首先用VS開啟上篇建立的專案（如果上篇沒有建立，可以從<a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter02">github</a> clone/下載下來），然後選擇上面Toolbar的：   </p><p><code>Project</code> -&gt; <code>Export Template</code></p><figure><a href="https://lh3.googleusercontent.com/-b2hTa_Z4ZgI/WaJCV35sqwI/AAAAAAAAWKo/9A4_uCJxJIwrzuV-OuutyK5mocI8z7vLACHMYCw/s1600-h/image%255B5%255D"><img width="654" height="647" title="Export Template位置" style="display: inline; background-image: none;" alt="Export Template位置" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[1](23).png" border="0" class="img-responsive"></a><br><figcaption>Export Template位置</figcaption></figure><div class="bs-callout bs-callout-warning">   上面提到的位置是VS 2017 - 2015的版本在 <code>Files</code> -&gt; <code>Export Template</code></div><p>  這個時候跳出的視窗請選擇 <code>Project Template</code>，下拉選擇要匯出的專案（應該只有一個）然後按下<kbd>Next</kbd></p><figure><a href="https://lh3.googleusercontent.com/-tML0TT4hfc0/WaJCYOi3NBI/AAAAAAAAWKw/9UecVMJ65cs1WmS8POeMlJ9TlknyZOPwgCHMYCw/s1600-h/image%255B8%255D"><img width="654" height="585" title="匯出類型選項" style="display: inline; background-image: none;" alt="匯出類型選項" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[2](17).png" border="0" class="img-responsive"></a><br><figcaption>匯出類型選項</figcaption></figure><p>  記下來是填寫一些基本資料：   </p><dl><dt>     Template Name    </dt><dd>     這個是出現在新增專案的時候呈現的名稱    </dd><dd></dd><dt>     Template Description    </dt><dd>     長一點介紹這個template的內容 - 會在新增專案右邊畫面出現。    </dd><dd></dd><dt>     Icon Image    </dt><dd>     新增專案的時候，範本呈現的圖示    </dd><dd></dd><dt>     Preview Image    </dt><dd>     預覽的時候的圖片    </dd><dd></dd></dl><div class="bs-callout bs-callout-warning">   這邊注意一下，預設<code>Automatically Import the template into visual studio</code>會是<em><strong>打鉤</strong></em>，建議<em><strong>不要勾</strong></em>，未來比較好管理。   </div><figure><a href="https://lh3.googleusercontent.com/-9utv7MQ2M3s/WaJCax3wKhI/AAAAAAAAWK4/oUV8JGGasvAPehVyE9yeWSu-9e8KUlfFQCHMYCw/s1600-h/image%255B11%255D"><img width="654" height="585" title="meta資訊的輸入畫面" style="display: inline; background-image: none;" alt="meta資訊的輸入畫面" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[3](14).png" border="0" class="img-responsive"></a><br><figcaption>meta資訊的輸入畫面</figcaption></figure><p>  按下<kbd>finish</kbd>之後，稍等一下，會自動打開檔案總管位置是匯出範本的地方。   </p></section><section><h2 id="WizKMOutline_1503805714768152">使用匯出的範本</h2><p> 範本匯出之後，可以看到是一個zip的檔案，這個檔案會需要丟到特定的地方VS就會自動接受到，VS接受到之後就可以在新增專案的時候找到這個template。  </p><section><h3 id="WizKMOutline_1503805714768815">Template放置的位置</h3><p> 在VS總共有兩個地方是放Template的：  </p><ol><li>系統等級 - 和VS安裝的時候進來</li><li>使用者等級 - 我們個人客制匯出</li></ol><dl><dt>    系統等級   </dt><dd><p>   這個放的位置在：    </p><p><code>\{VisualStudioInstallationDirectory}\Common7\IDE\ProjectTemplates\{Language}\{category\\{Locale}\</code></p><p>   舉例來說：    </p><p><code>c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ProjectTemplates\CSharp\Web\1033\WebApplicationProject40\</code></p><p>   這個template是VS 2017在<code>C#</code>-&gt;<code>Web</code>-&gt;英文(1033)的<code>WebApplicationProject40</code>專案位置    </p><p>   一般來說，這邊路徑的template<em><strong>不會去動</strong></em>。    </p></dd><dd></dd><dt>    使用者等級   </dt><dd><p>   這個預設放在：     <code>\{My Documents}\{Visual Studio Version}\Templates\ProjectTemplates\{Language}\</code></p><p>   例如：     <code>C:\Documents and Settings\UserName\My Documents\Visual Studio Version\Templates\ProjectTemplates\Visual C#\</code>放的是C#範本的位置    </p><div class="bs-callout bs-callout-warning">    使用者等級是可以改的，在VS裡面的<code>Option</code> -&gt; <code>Projects and Soultion</code>那邊是可以調整的，因此如果等一下範本匯入沒有作用，確認一下這邊的路徑是否正確。     <figure><a href="https://lh3.googleusercontent.com/-ZKw-Upf5DtA/WaJCdNahl9I/AAAAAAAAWLA/3N7sl9H7LuQ5n4xa2dtuO9l2rrDd_3ygQCHMYCw/s1600-h/image%255B14%255D"><img width="654" height="442" title="設定的畫面" style="display: inline; background-image: none;" alt="設定的畫面" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[4](14).png" border="0" class="img-responsive"></a><figcaption>設定的畫面</figcaption></figure></div></dd><dd></dd></dl></section><section><h3 id="WizKMOutline_1503805714768579">匯入template</h3><p>  既然了解了template存放的位置，我們就可以把匯出的template放到正確的位置。   </p><p>  舉例來說，我這個是C#的template，因此我會放在C#的資料夾下面，以我的來說就是：   <br><code>D:\Library\Documents\Visual Studio 2017\Templates\ProjectTemplates\Visual C#\</code></p><figure><a href="https://lh3.googleusercontent.com/-E6kSYfYC1RQ/WaJCg5dIVFI/AAAAAAAAWLI/g1EvsGuoLMw_0AfIZw9-kT5Up755u9UzACHMYCw/s1600-h/image%255B17%255D"><img width="654" height="220" title="放的位置" style="display: inline; background-image: none;" alt="放的位置" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[5](8).png" border="0" class="img-responsive"></a><br><figcaption>放的位置</figcaption></figure></section><section><h3 id="WizKMOutline_1503805714768216">測試範本</h3><p>  這個時候就可以開一個VS，然後選擇，<code>New</code> -&gt; <code>Project</code>，在<code>Visual C#</code>下面就會看到我們匯出的範本：   </p><figure><a href="https://lh3.googleusercontent.com/-Dhz4FLSMRr4/WaJCkxBorwI/AAAAAAAAWLQ/70f-TkzdBBgAYP2UhTKJDISL34MION0NACHMYCw/s1600-h/image%255B20%255D"><img width="654" height="375" title="新增template，找到匯出的Template" style="display: inline; background-image: none;" alt="新增template，找到匯出的Template" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[6](6).png" border="0" class="img-responsive"></a><br><figcaption>新增template，找到匯出的Template</figcaption></figure><p>  然後new出來之後會發現namespace什麼有跟著變換，然後結構和我們建立的專案一樣：   </p><figure><a href="https://lh3.googleusercontent.com/-d2D0WhVMDig/WaJCoVnLuhI/AAAAAAAAWLY/474rq8qmtXw4hP7kYu4Vd5K4OctY_lQEACHMYCw/s1600-h/image%255B23%255D"><img width="654" height="211" title="new出來的結果" style="display: inline; background-image: none;" alt="new出來的結果" src="/posts/migrate/2017-08-27-buildYourOwnTemplate-create-VS-template-using-export_Asset/image_thumb[7](5).png" border="0" class="img-responsive"></a><br><figcaption>new出來的結果</figcaption></figure></section></section><section><h2 id="WizKMOutline_1503805714768757">結語</h2><p>  在這篇介紹了如何把現有專案透過匯出的方式產生zip檔案，然後介紹範本讀取的路徑並且測試建立出來。   </p><p>  到這邊為止，其實已經能夠自己建立出template了，不過會發現有些細節還有問題，例如template預設的名稱看起來很奇怪，還有假設想要調整template顯示名稱能夠怎麼做，還有是否能夠在<code>Visua C#</code>下面建立自己的分類等。   </p><p>  這些細節的部分，將會在下篇介紹，如何微調template和一些常見的小問題。   </p></section><section><h2 id="WizKMOutline_1503805714768242">參考資料</h2><dl><dt>     template路徑位置（英文）    </dt><dd><a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-locate-and-organize-project-and-item-templates">How to: Locate and Organize Project and Item Templates</a></dd><dd></dd><dt>     匯出建立template（英文）    </dt><dd><a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-project-templates">How to: Create Project Templates</a></dd><dd></dd></dl></section>  <div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:2bd05b5e-4a9c-4d5d-9353-7b18f9b9b8a9" style="margin: 0px; padding: 0px; float: none; display: inline;">標籤: <a href="/tags/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag">「打造自己的template-建立一致性程式碼」</a>,<a href="/tags/Visual+Studio" rel="tag">Visual Studio</a></div>