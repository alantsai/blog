Title: "[從.Net工程師的角度來看DevOps 24]免費build私人Repo的CI Service - Visual Studio Team Service介紹"
Published: 2017-12-13
Modified: 2017-12-13
Image: /posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb(58).png
Tags: [".net","「ithome 第八屆鐵人賽」","devops","「從.net工程師的角度來看devops」"]
RedirectFrom: 2017/12/devopsSeries-intro-to-free-ci-service-visual-studio-team-services.html
Series: ["「iThome 第八屆鐵人賽」","「從.Net工程師的角度來看DevOps」"]
---
<section><figure><a href="https://lh3.googleusercontent.com/-MqYttQdQUIQ/WjFG_fsnnJI/AAAAAAAAXGU/_LGfn-y9R9A8KdIgXk6Nj5J_JOc9VIqTwCHMYCw/s1600-h/image%255B2%255D"><img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb(58).png" border="0" class="img-responsive"></a><br><figcaption>圖片來源：https://pixabay.com/en/books-spine-colors-pastel-1099067/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/</figcaption><br></figure></section><section><p>  在上一篇（<a href="http://blog.alantsai.net/2017/12/devopsSeries-integrate-build-script-to-appveyor-set-badge-status-in-github.html">[從.Net工程師的角度來看DevOps 23]在AppVeyor執行Build Script - 整合build資訊到github</a><span style="line-height: 1.6;">）介紹完了如何用AppVeyor執行我們定義的build script，不過有時候我們有私人的repo也希望做CI，這個時候免費版本的AppVeyor就不夠了。</span></p><p>  這邊將會介紹另外一個能夠build私人repo，由Microsoft提供的免費CI服務，Visual Studio Team Service（VSTS）。   </p><p>  這篇先看內建VSTS所提供的方式來建制範例專案，在下篇在改成執行我們的build script。   </p></section><section><a name="KMContentPageTopID" id="KMContentPageTopID"></a><div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"><ul style="margin: 0px 0px 0px 20px;"><li><a style="line-height: 1.6;" href="#WizKMOutline_1513178356211824" ;="">VSTS小檔案</a><br></li><li><a style="line-height: 1.6;" href="#WizKMOutline_1513178356211438" ;="">用VSTS內建的build task來做CI</a><br></li><li><a style="line-height: 1.6;" href="#WizKMOutline_1513178356211540" ;="">檢查執行結果</a><br></li><li><a style="line-height: 1.6;" href="#WizKMOutline_1513178356211784" ;="">結語</a><br></li></ul></div></section><div class="bs-callout bs-callout-info">   題外話，假設之前已經有VSTS帳號，想要移動Region到East Asia，可以參考這篇：<a href="http://blog.alantsai.net/2017/12/vsts-how-to-change-account-region-to-east-asia.html">[VSTS]如何調整Visual Studio Team Service的區域(Region)</a></div><a name="more"></a><section><h2 id="WizKMOutline_1513178356211824">VSTS小檔案</h2><p>  VSTS是微軟提供的一個免費的Team Foundation Server（TFS）的雲端版本，build只是他其中一部分的功能（也是這個系列唯一會用到的部分）。   </p><ul><li>網址：<a href="https://www.visualstudio.com/zh-hant/team-services/?rr=https%3A%2F%2Fwww.google.com.tw%2F">https://www.visualstudio.com/zh-hant/team-services/</a></li><li>免費版本build有：1個月240分鐘</li></ul></section><section><h2 id="WizKMOutline_1513178356211438">用VSTS內建的build task來做CI</h2><p>  和AppVeyor一樣，先了解如果沒有build script的情況下，VSTS如何設定build步奏。   </p><p>  在開始之前，先需要在VSTS的帳號建立一個專案：   </p><figure><a href="https://lh3.googleusercontent.com/-_fH7qfjosUU/WjFHCLrSdbI/AAAAAAAAXGc/w6mqRbxlXgQpGoxo_Fiqy73OzbbWOr7LACHMYCw/s1600-h/image%255B5%255D"><img width="654" height="502" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[1](52).png" border="0" class="img-responsive"></a><br><figcaption>建立專案</figcaption></figure><p>  因為只使用到build，可以捲動到下面，直接選<code>Setup Build</code>：   </p><figure><figcaption><a href="https://lh3.googleusercontent.com/-wrh-uMxEfJc/WjFHEmss7nI/AAAAAAAAXGk/HIHPcsW9r7MNAzPhFke3K4y6Tor_BartgCHMYCw/s1600-h/image%255B8%255D"><img width="654" height="525" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[2](42).png" border="0" class="img-responsive"></a><br></figcaption><figcaption>建立一個build definition</figcaption></figure><p>  這個會把我們帶到Build的頁簽，選擇<code>New Definition</code></p><figure><a href="https://lh3.googleusercontent.com/-UpNttGMFWBA/WjFHKjiKcYI/AAAAAAAAXGs/lWKBHVYGf6Yb54eUd-Ln4YPANRhoaGb_QCHMYCw/s1600-h/image%255B11%255D"><img width="654" height="358" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[3](39).png" border="0" class="img-responsive"></a><br><figcaption>建立build definition</figcaption></figure><p>  可以選擇一個微軟定義好用來建立<code>.Net Desktop</code>的template：   </p><figure><a href="https://lh3.googleusercontent.com/-UgIZDt_pC9A/WjFHT-FFDFI/AAAAAAAAXG0/03_swm57liAqeWvk84Z-hR3XLT1Oht27gCHMYCw/s1600-h/image%255B14%255D"><img width="654" height="272" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[4](39).png" border="0" class="img-responsive"></a><br><figcaption>選擇template</figcaption></figure><p>  再來要設定source的位置：   </p><ol><li>選擇左邊的<code>Get Source</code></li><li>選擇<code>Github</code></li><li>做驗證 - 可以用OAuth或者github的personal token</li><li>選擇要build的repo</li></ol><figure><a href="https://lh3.googleusercontent.com/-oipbzRcJnmo/WjFHcCdxRgI/AAAAAAAAXG8/W8EEWcKK8-wlpIWCv_QCswWkU1nZfutUQCHMYCw/s1600-h/image%255B17%255D"><img width="654" height="354" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[5](28).png" border="0" class="img-responsive"></a><br><figcaption>設定source</figcaption></figure><p>  選擇右上角的<code>Save &amp; Queue</code>然後設定這個build definition的名稱之後儲存：   </p><figure><a href="https://lh3.googleusercontent.com/-enTRW4nKu-E/WjFHfHUgOpI/AAAAAAAAXHI/Mc6TyEL3qToaMtRANBkvZjX-ElyF_xRXACHMYCw/s1600-h/image%255B20%255D"><img width="654" height="365" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[6](25).png" border="0" class="img-responsive"></a><br><figcaption>儲存並且執行build</figcaption></figure><div class="bs-callout bs-callout-warning">   如果依照上面的步奏直接建立build definition其實會build不起來，需要調整設定檔案裡面的sln檔案位置的設定（要給完整檔案路徑）。這也告訴我們如果沒有自己的build script，    從一個build server到另外一個其實會有些工，更別說無法local執行和CI Server一樣的動作。   </div></section><section><h2 id="WizKMOutline_1513178356211540">檢查執行結果</h2><p>  過了一些時間之後，可以看到build成功：   和AppVeyor比較起來，可以看到VSTS在呈現的畫面比較漂亮一些，左邊是那些定義過的steps執行結果，右邊則是一個簡單的summary。因為內建step有執行test（不過是MSTest），所以有看到test結果（但是只有一筆）。   </p><figure><a href="https://lh3.googleusercontent.com/-IU4tN-TWQ5g/WjFHhRvyGVI/AAAAAAAAXHQ/-oaKDhf1_fARwD811OE-jqbS7RpJaYp9ACHMYCw/s1600-h/image%255B23%255D"><img width="654" height="278" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-12-13-devopsSeries-intro-to-free-ci-service-visual-studio-team-services_Asset/image_thumb[7](19).png" border="0" class="img-responsive"></a><br><figcaption>build成功</figcaption></figure></section><section><h2 id="WizKMOutline_1513178356211784">結語</h2><p>  這篇介紹了VSTS的build服務，並且用內建的Template來建立出build definition的檔案。   </p><p>  透過這篇的操作，也會發現設定build definition和AppVeyor非常不一樣，因此在沒有build script的情況下，要從AppVeyor移動到VSTS有一些工要做（以我們這個範例來說，其實內建的template不做任何事情是沒有辦法build起來），   因此build script非常重要。   </p><p>  下篇將會調整VSTS使用我們的build script做build。   </p></section><section>    <div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:32c6298b-420b-46d4-b7fe-af5954dfefad" style="margin: 0px; padding: 0px; float: none; display: inline;">標籤: <a href="/tags/%e3%80%8c%e5%be%9e.Net%e5%b7%a5%e7%a8%8b%e5%b8%ab%e7%9a%84%e8%a7%92%e5%ba%a6%e4%be%86%e7%9c%8bDevOps%e3%80%8d" rel="tag">「從.Net工程師的角度來看DevOps」</a>,<a href="/tags/%e3%80%8ciThome+%e7%ac%ac%e5%85%ab%e5%b1%86%e9%90%b5%e4%ba%ba%e8%b3%bd%e3%80%8d" rel="tag">「iThome 第八屆鐵人賽」</a>,<a href="/tags/devops" rel="tag">devops</a>,<a href="/tags/.net" rel="tag">.net</a></div></section>