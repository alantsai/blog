Title: "[打造自己的template-建立一致性程式碼][06]建立Item Template"
Published: 2017-08-31
Modified: 2017-08-31
Image: /posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb(29).png
Tags: ["visual studio","「打造自己的template-建立一致性程式碼」"]
RedirectFrom: 2017/08/buildYourOwnTemplate-create-item-template.html
Series: ["「打造自己的template-建立一致性程式碼」"]
---
<section><figure><a href="https://lh3.googleusercontent.com/-wwVvmq3dNuw/WabzDC9CTfI/AAAAAAAAWN8/_C7VSoY0F8U8D9NtIXPJkbOgAyId43jDgCHMYCw/s1600-h/image%255B2%255D"><img width="654" height="290" title="建立Item Template" style="display: inline; background-image: none;" alt="建立Item Template" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb(29).png" border="0" class="img-responsive"></a><br><figcaption>圖片來源：https://pixabay.com/en/annual-report-book-brochure-686343/</figcaption></figure></section><section><p>  在上篇（<a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-create-multi-project-template.html">[05]建立多專案(multi project)的Template</a>）了解了如何建立Multi Project了之後，   Project Template基本上就告一個段落了。   </p><p>  在這篇則是針對另外一種Template：Item Template的建立方式做一個介紹。   </p></section><section><div class="bs-callout bs-callout-default">匯出用的範例程式碼 <a href="https://github.com/alantsai-samples/mhat-visualstudio-template/releases/tag/sample%2Fchapter05">github mhat-visualstudio-template sample/chapter05</a></div></section>   <section> <a name="KMContentPageTopID" id="KMContentPageTopID"></a><div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"><ul style="margin: 0px 0px 0px 20px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762816" ;="">建立Item Template</a><br></li><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762684" ;="">透過匯出的方式建立</a><br></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762953" ;="">丟到正確的路徑安裝到VS</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762322" ;="">測試結果</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762596" ;="">Item Template和Project Template的不同之處</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762590" ;="">結語</a><br></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1504112955762450" ;="">參考資料</a><br></li></ul></div></section>    <a name="more"></a> <section><h2 id="WizKMOutline_1504112955762816">建立Item Template</h2><p>  Item Template是在建立在專案裡面項目的時候可以選的一種template。以我們的例子來說，今天要寫一個ProcessTemplate，那麼最快的方式就是建立一個class繼承<code>BaseExecuteProcessTemplate</code>。   </p><p>  因此假設在建立class的時候，這個繼承關係就建立好了，開發者根本不需要看文件確認繼承的class名稱，加快開發者開發並且程式碼一致，這就是Item Template的價值所在。   </p><p>  如果要建立一個Item Template，基本上和Project Template差不多：   </p><ol><li>透過匯出的方式建立</li><li>丟到正確路徑安裝到VS</li><li>測試結果</li></ol><section><h3 id="WizKMOutline_1504112955762684">透過匯出的方式建立</h3><p>   想必在建立Project Template匯出的時候，應該有注意到另外一個選項是Item Template。    </p><p>   因此，就是透過選Item Template、再來選擇哪個Class（只能夠單選）、再來選擇要包含的dll最後填完資訊就匯出完成了。    </p><div class="bs-callout bs-callout-info">    同Project Template一樣，匯出的路徑一樣在（預設）<code>%userprofile%\Documents\Visual Studio {version}\My Exported Templates</code></div><figure><a href="https://lh3.googleusercontent.com/-OA6Lh-4EGfY/WabzGQ33KGI/AAAAAAAAWOE/byyyQXCpkuYyG7q3ePUTLJGFBBR2v-mygCHMYCw/s1600-h/image%255B5%255D"><img width="654" height="585" title="匯出選擇Item Template" style="display: inline; background-image: none;" alt="匯出選擇Item Template" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[1](26).png" border="0" class="img-responsive"></a><br><figcaption>匯出選擇Item Template</figcaption></figure><figure><a href="https://lh3.googleusercontent.com/-Cf2VGdSnk7M/WabzJwVHPvI/AAAAAAAAWOM/BsLofCvyUncnYUduzRmDOrVBDL5EErKEgCHMYCw/s1600-h/image%255B8%255D"><img width="654" height="585" title="" style="display: inline; background-image: none;" alt="" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[2](20).png" border="0" class="img-responsive"></a><br><figcaption>選擇要匯出的檔案，只能單個檔案</figcaption></figure><figure><a href="https://lh3.googleusercontent.com/-7Z0m6faXNGk/WabzNR8frLI/AAAAAAAAWOU/AveZKV_0VzstqQT-IESNPFeAFmnliShawCHMYCw/s1600-h/image%255B11%255D"><img width="654" height="585" title="" style="display: inline; background-image: none;" alt="" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[3](17).png" border="0" class="img-responsive"></a><br><figcaption>再來可以選擇要Reference的dll</figcaption></figure><div class="bs-callout bs-callout-warning">    這邊reference的時候不會包含實際的dll，所以如果那台機器沒有裝那個dll在gac - 基本上會有問題。因此不建議加入非gac的dll    </div><figure><a href="https://lh3.googleusercontent.com/-pnQRPkQlIjs/WabzQN0sO_I/AAAAAAAAWOc/t1-VI1I2Gr8fcYExdQjkQEh7_0kysdqQwCHMYCw/s1600-h/image%255B14%255D"><img width="654" height="585" title="" style="display: inline; background-image: none;" alt="" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[4](17).png" border="0" class="img-responsive"></a><br><figcaption>加入相關資訊  - 然後完成</figcaption></figure><div class="bs-callout bs-callout-warning">    同Project Template一樣，<em>不建議勾選</em> <code>Automatically Import the template into visual studio</code></div></section><section><h2 id="WizKMOutline_1504112955762953">丟到正確的路徑安裝到VS</h2><p>   同Project Template一樣，Item Template也有分兩個位置：    </p><ol><li>系統等級 - VS安裝的時候</li><li>使用者等級 - 個人安裝範本的位置</li></ol><dl><dt>    系統等級   </dt><dd><p>   這個放的位置在：    </p><p><code>\{VisualStudioInstallationDirectory}\Common7\IDE\ProjectTemplates\{Language}\{category\\{Locale}\</code></p><p>   舉例來說：    </p><p><code>c:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\ProjectTemplates\CSharp\Web\1033\WebApplicationProject40\</code></p><p>   這個template是VS 2017在<code>C#</code>-&gt;<code>Web</code>-&gt;英文(1033)的<code>WebApplicationProject40</code>專案位置    </p><p>   一般來說，這邊路徑的template<em><strong>不會去動</strong></em>。    </p></dd><dd></dd><dt>    使用者等級   </dt><dd><p>   這個預設放在：     <code>\{My Documents}\{Visual Studio Version}\Templates\ItemTemplates\{Language}\</code></p><p>   例如：     <code>C:\Documents and Settings\UserName\My Documents\Visual Studio Version\Templates\ItemTemplates\Visual C#\</code>放的是C#範本的位置    </p><div class="bs-callout bs-callout-warning">    使用者等級是可以改的，在VS裡面的<code>Option</code> -&gt; <code>Projects and Soultion</code>那邊是可以調整的，因此如果等一下範本匯入沒有作用，確認一下這邊的路徑是否正確。     <figure><a href="https://lh3.googleusercontent.com/-zrL8ApjqCbY/WabzS7yy7xI/AAAAAAAAWOk/U6oUaAhGkrcm2Z1rwRfoQ5g17v2Dms3lwCHMYCw/s1600-h/image%255B17%255D"><img width="654" height="442" title="" style="display: inline; background-image: none;" alt="" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[5](10).png" border="0" class="img-responsive"></a><figcaption>設定的畫面</figcaption></figure></div></dd><dd></dd></dl><p>   因此把匯出的zip檔案丟到正確的位置（如果需要「分類」記得依照結構建立即可，如果不確定請參考：<a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931924">[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式#管理Project Template到某個分類</a>）    </p><figure><a href="https://lh3.googleusercontent.com/-_1RRRtUuoUA/WabzWX4L0fI/AAAAAAAAWOs/cRtpu-f1j_Aevf_DSV9lUAtdMwOAML5owCHMYCw/s1600-h/image%255B20%255D"><img width="654" height="173" title="" style="display: inline; background-image: none;" alt="" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[6](7).png" border="0" class="img-responsive"></a><br><figcaption>丟入正確的路徑</figcaption></figure></section><section><h2 id="WizKMOutline_1504112955762322">測試結果</h2><p>    如果丟入路徑正確，可以再建立的時候找到     </p><figure><a href="https://lh3.googleusercontent.com/-z9_FnynuC0I/WabzbCqAXdI/AAAAAAAAWO0/ea4IZ3u1-zsPasWKhT_HXebX5GiSVVXawCHMYCw/s1600-h/image%255B26%255D"><img width="654" height="375" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2017-08-31-buildYourOwnTemplate-create-item-template_Asset/image_thumb[8](6).png" border="0" class="img-responsive"></a><br><figcaption>建立Item</figcaption></figure><div class="bs-callout bs-callout-warning">    假設VS沒有出現，可以把cache刪掉看看，cache路徑<code>%appdata%\Microsoft\VisualStudio\ItemTemplatesCache</code>。（如果不清楚可以參考<a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html#WizKMOutline_1503822127931725">[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式#更新template - 如何讓vs重新刷新</a>）只需要注意Item Template是<code>ItemTemplateCache</code></div></section></section><section><h2 id="WizKMOutline_1504112955762596">Item Template和Project Template的不同之處</h2><p>  打開<code>vstemplate</code>會發現，其實Item Template和Project Template基本上差不多，唯一的主要不同之處在於<code>vstemplate</code>裡面的<code>VSTemplate</code>的<code>Type="Item"</code>。   </p><p>  所以之前章節提到的微調其實也是適用於在Item template裡面。   </p><div class="bs-callout bs-callout-info">   甚至可以透過微調的方式達到Item Template會建立多個檔案和資料夾。不過這個留在外來在介紹。   </div></section><section><h2 id="WizKMOutline_1504112955762590">結語</h2><p>  到目前為止其實建立Project Template和Item Template基本上已經沒有什麼問題了，其實會匯出和了解<code>vstemplate</code>就能夠打造出適合自己的template。   </p><p>  不過到目前為止應該會發現到這種方式有幾個不方便之處，其中很大一個部分就是版控（也因為這樣這幾篇其實都沒有source code可以參考）。   </p><p>  因此在接下來將會專注于如何讓建立template這件事情更容易版控和更容易安裝和使用。   </p></section><section><h2 id="WizKMOutline_1504112955762450">參考資料</h2><dl><dt><a href="http://blog.alantsai.net/2017/08/buildYourOwnTemplate-understand-vstemplate-make-vs-refresh-template-cache.html">[04]了解vstemplate來微調匯出的Template和強制VS更新Template的方式</a></dt><dd>     微調template的相關資訊和常見的問題。    </dd><dd></dd><dt><a href="https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-item-templates">How to: Create Item Templates</a></dt><dd>     官方介紹建立Item Template    </dd><dd></dd></dl></section> <section> <div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:7f8394e1-6708-416f-9b40-2e6d3ea8ae28" style="margin: 0px; padding: 0px; float: none; display: inline;">標籤: <a href="/tags/%e3%80%8c%e6%89%93%e9%80%a0%e8%87%aa%e5%b7%b1%e7%9a%84template-%e5%bb%ba%e7%ab%8b%e4%b8%80%e8%87%b4%e6%80%a7%e7%a8%8b%e5%bc%8f%e7%a2%bc%e3%80%8d" rel="tag">「打造自己的template-建立一致性程式碼」</a>,<a href="/tags/Visual+Studio" rel="tag">Visual Studio</a></div></section>