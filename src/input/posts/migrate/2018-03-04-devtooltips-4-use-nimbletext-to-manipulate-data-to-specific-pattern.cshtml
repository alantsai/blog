Title: "[開發工具小技巧]NimbleText - 資料處理產生符合特定結構的好用小工具"
Published: 2018-03-04
Modified: 2018-03-04
Image: 2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset/image_thumb(83).png
Tags: ["「開發工具小技巧」","c#","tool","sql"]
RedirectFrom: 2018/03/devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern.html
Series: ["「開發工具小技巧」"]
---
<section><figure><a href="https://lh3.googleusercontent.com/-uHqdoNQjEiA/WprcDeVIi2I/AAAAAAAAXxE/0UvmFj5hCYwlhiuv7evX2rOa-X4U36DUACHMYCw/s1600-h/image%255B2%255D"><img width="654" height="290" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset\image_thumb(83).png" border="0"></a><br /><figcaption>圖片來源：https://pixabay.com/en/confused-muddled-illogical-880735/ 和 https://blog.xebialabs.com/2016/03/21/essential-devops-terms/</figcaption></figure></section><section><p>標題可能有點看不懂，因為不太確定怎麼下比較符合這個工具的主要作用。不過給一個情境應該就能夠比較了解。</p><p>            有時候需要匯入資料的時候，可能會收到一個email清單，這個email清單需要匯入到DB裡面，如果是產生出匯入的sql語法請問會怎麼做呢？         </p><p>            如果這個email清單只有10筆，手刻sql語法問題還不大，但是如果有1000筆email呢？         </p><p>            在換個和程式開發比較相關的情境，假設SA開了一個清單告訴你這個class所需要的Property有什麼，請問如何快速的產生出這個property呢？         </p><p>            在這篇將會介紹，如何用NimbleText這個工具快速做到上面兩個情境的需求。         </p></section>         <section> <a name="KMContentPageTopID" id="KMContentPageTopID"></a><div id="divKMOutline" style="border-style: groove none; margin: 10px 0px;"><ul style="margin: 0px 0px 0px 20px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494661" ;="">NimbleText介紹</a><br /></li><ul style="margin: 0px 0px 0px 30px;"><ul style="margin: 0px 0px 0px 30px;"><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494912" ;="">NimbleText小檔案</a><br /></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494278" ;="">版本的差異</a><br /></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494215" ;="">使用介紹</a><br /></li></ul><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494197" ;="">使用情境1 - 依照清單產生出insert sql語法</a><br /></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494629" ;="">使用情境2 - 產生出class的property</a><br /></li><li><a style="line-height: 1.6; font-size: 15px;" href="#WizKMOutline_1520098053494642" ;="">結語</a><br /></li></ul></div></section>         <a name='more'></a><section><h2 id="WizKMOutline_1520098053494661">NimbleText介紹</h2><div class="bs-callout bs-callout-default"><h4 id="WizKMOutline_1520098053494912">NimbleText小檔案</h4><ul><li><em>官網</em>:<a href="http://nimbletext.com/">http://nimbletext.com/</a></li><li><em>Live(線上版)</em>:<a href="http://nimbletext.com/Live">http://nimbletext.com/Live</a></li><li><em>Desktop</em>: <a href="http://nimbletext.com/Download/NimbleText.exe">直接下載</a> </li><li><em>版本差異</em>: <a href="http://nimbletext.com/Home/Professional">http://nimbletext.com/Home/Professional</a> </li></ul></div><p>            NimbleText這個工具作者給他的描述是：<em>Manipulate text and data with light-weight patterns</em>。         </p><p>            簡單來說，就是把清單資料依照自己定義的範本去產生出內容。         </p><p>            聽起來還是有點抽象，不過等一下有範例的時候就會比較清楚。         </p><section><h3 id="WizKMOutline_1520098053494278">版本的差異</h3><p>                NimbleText有3個版本：                 </p><ol><li><em>Live</em> - 線上版</li><li><em>Desktop</em> - 應用程式版</li><li><em>Desktop + License</em> - 應用程式版加買license</li></ol><p>                這個工具非常佛心，基本上Live和Desktop都是免費，只有進階功能才需要License。以我目前使用來說，其實Live就很夠用了。             </p><figure><a href="https://lh3.googleusercontent.com/-BQg9jSW6sa8/WprcG6QD5zI/AAAAAAAAXxM/3QFlQASEsmsSVuEYeRIc2DfE13ETxAzhACHMYCw/s1600-h/image%255B5%255D"><img width="654" height="660" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset\image_thumb[1](70).png" border="0"></a><br /><figcaption>功能版本差異 - 此圖沒有列出全部，詳細請看：http://nimbletext.com/Home/Professional</figcaption></figure></section><section><h3 id="WizKMOutline_1520098053494215">使用介紹</h3><p>                這邊會介紹<em>Live</em>的版本。             </p><p>                整個畫面有3個部分：                 </p><ol><li><em>For each row in the list</em>: 每一筆要被處理的資料</li><li><em>Subsitute using this pattern</em>:範本的內容</li><li><em>Result</em>:最後產生的結果</li></ol><figure><a href="https://lh3.googleusercontent.com/-3_1UKiDO5iA/WprcLokqFFI/AAAAAAAAXxU/9FeWXNEEGE0Frd4OqDr1uQ2cn9oZYh5SwCHMYCw/s1600-h/image%255B8%255D"><img width="654" height="840" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset\image_thumb[2](58).png" border="0"></a><br /><figcaption>3個基本功能的畫面</figcaption></figure><p>                在「結果」的右邊部分，能夠設定每一筆資料的:                 </p><ol><li><em>column separator</em>: 切割字</li><li><em>row separtor</em>: 斷行字</li><li><em>insert</em>: 預存的範本</li></ol><figure><a href="https://lh3.googleusercontent.com/-XOIVFBiTYI4/WprcSKvqNqI/AAAAAAAAXxc/96OYXGrj_aMp51d-zu-IjVS57_G79IiGQCHMYCw/s1600-h/image%255B11%255D"><img width="654" height="60" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset\image_thumb[3](54).png" border="0"></a><br /><figcaption>切割及斷行字</figcaption></figure><p>                最簡單的使用方式就是：                 </p><ol><li>把要處理的資料丟到<code>For each row in the list</code></li><li>在<code>Subsitute using this pattern</code>調整結果的範本。可以使用 <code>$0</code>代表第一個切割欄位，以此類推</li><li>在<code>Result</code>把最後結果複製出來</li></ol></section></section><section><h2 id="WizKMOutline_1520098053494197">使用情境1 - 依照清單產生出insert sql語法</h2><p>            這個情景是，有一個清單是insert的一部分值，例如要把每一個email都產生出一個insert sql語法。         </p><p>            假設，拿到的清單如下： </p><pre class="brush: plain;">test@@test.com<br />bbb@@test.com<br />ccc@@test.com<br /></pre><p>            最後要匯入的sql語法是要到<code>EpaperSubscribe</code>table裡面的<code>email</code>欄位：             </p><pre class="brush: plain;">INSERT INTO EpaperSubscribe (email)<br />VALUES ('$0');</pre><p>            最後就可以把<code>Result</code>複製出來在SSMS執行。         </p><figure><a href="https://lh3.googleusercontent.com/-LcBUIVvqQAo/WprcUiiDqNI/AAAAAAAAXxk/hXg1s8jEuMsYsHLJ00x-tiDZY9lzEYH6QCHMYCw/s1600-h/image%255B14%255D"><img width="654" height="845" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset\image_thumb[4](56).png" border="0"></a><br /><figcaption>最後結果截圖</figcaption></figure></section><section><h2 id="WizKMOutline_1520098053494629">使用情境2 - 產生出class的property</h2><p>            假設SA開好class裡面所有的property名稱及形態，怎麼快速產生這些property？         </p><p>            假設得到的property類型和名稱清單如下：             </p><pre class="brush: plain;">int Id<br />string Name<br />DateTime CREATEDATE</pre><p>            要產生的property為public包含get及set的版本，範本會是：             </p><pre class="brush: plain;">public $0  &lt;% $1.toPascalCase() %&gt; { get; set;}<br />            </pre><div class="bs-callout bs-callout-info">                這邊注意到，最後一個欄位名稱是<em>全部大寫</em>，不過透過NimbleText的功能可以建立出符合C#命名規則的Property名稱。             </div><div class="bs-callout bs-callout-info">                如果說要建立出包含private variable的property，可以從範本裡面選做參考。             </div><div class="bs-callout bs-callout-warning">                上面那個範例要能夠成功，記得<em>column separator</em>要改成<em>空白</em>。             </div><p>            最後產生的結果就直接貼到C#的class裡面。         </p><figure><a href="https://lh3.googleusercontent.com/-QjNh-qr_yCk/WprcbEzLAoI/AAAAAAAAXxs/INIpSdKvmaEaO_J3HJQqy1M0ZZJx3ATFQCHMYCw/s1600-h/image%255B17%255D"><img width="654" height="450" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="/posts/migrate/2018-03-04-devtooltips-4-use-nimbletext-to-manipulate-data-to-specific-pattern_Asset\image_thumb[5](38).png" border="0"></a><br /><figcaption>產生的最後結果</figcaption></figure></section><section><h2 id="WizKMOutline_1520098053494642">結語</h2><p>            如果沒有NimbleText要達到上面的功能，一般會使用類似RegEx搭配產生，但是實際上並不好寫。         </p><p>            透過使用NimbleText讓整個的操作上變得非常的簡單，並且透過把這些pattern記錄下來隨時都可以讓一樣資料結構產生出需要的結果。         </p><p>            如果有更好的工具及做法也歡迎大家留言給我。         </p></section><section>             <div class="wlWriterEditableSmartContent" id="scid:77ECF5F8-D252-44F5-B4EB-D463C5396A79:09e0d3b0-4fe8-4ff4-b457-8b19256b9978" style="margin: 0px; padding: 0px; float: none; display: inline;">標籤: <a href="/tags/%e3%80%8c%e9%96%8b%e7%99%bc%e5%b7%a5%e5%85%b7%e5%b0%8f%e6%8a%80%e5%b7%a7%e3%80%8d" rel="tag">「開發工具小技巧」</a>,<a href="/tags/tool" rel="tag">tool</a>,<a href="/tags/C%23" rel="tag">C#</a>,<a href="/tags/sql" rel="tag">sql</a></div></section>